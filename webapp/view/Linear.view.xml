
<mvc:View
	height="100%"
	controllerName="gfex.petrobras.fornmanager.controller.Linear"
	xmlns:form="sap.ui.layout.form"
	xmlns:core="sap.ui.core"
	xmlns:u="sap.ui.unified"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:f="sap.ui.layout.form"
	xmlns:l="sap.ui.layout"
	xmlns:t="sap.ui.table"
	xmlns:upload="sap.m.upload"
	xmlns="sap.m">
	
	<Wizard
	visible="{= ${/selectedShowCase} === 'linear' }"
		id="FornGfexWizard"
		finishButtonText="Finalizar"
		height="auto"
		class="sapUiResponsivePadding--header sapUiResponsivePadding--content"
		complete="completedHandler"
		currentStep="BasicDataStep">
		<WizardStep id="BasicDataStep_" title="{i18n>basicDataStep}" activate="onActivate"
			icon="sap-icon://SAP-icons-TNT/data-store">
			<ObjectHeader
				binding="{/supplierS4/}"
				title="{SupplierName}"
				number="{SupplierId}"
				numberUnit="{CurrencyCode}">
				<statuses>
					<ObjectStatus
						text="{PostalCode}" />
					<ObjectStatus
						text="{State}/{Country}" />
				</statuses>
				<ObjectAttribute text="{Street}" />
				<ObjectAttribute text="{District}" />
			</ObjectHeader>
		</WizardStep>
		<WizardStep id="CnpjStep_" title="{i18n>cnpjStep}" activate="onActivate" 
			icon="sap-icon://document">
			<Text text="{i18n>descCnpjStep}"/>	
			<form:SimpleForm labelSpanL="1"  labelSpanM="1" labelSpanS="6" class="sapUiLargeMarginTop"
				editable="true" layout="ResponsiveGridLayout">
				<form:content class="sapUiForm">
					<!-- <Label text="{i18n>cnpj}" required="true"/> -->

					<Input valueStateText="" id="cnpj_" submit="includeCnpj"
						placeholder="Insira aqui a chave do fornecedor" value="{/cnpj}"/> 
					<Button text="Adicionar" type="Transparent" press="includeCnpj" ariaLabelledBy="editButtonLabel">
						<layoutData>
							<l:GridData span="XL1 L1 M1 S1" />
						</layoutData>
					</Button>
				</form:content>
			</form:SimpleForm>
			<form:SimpleForm editable="true" layout="ResponsiveGridLayout">	
				<Table id="cnpjTable_" inset="false"
					items="{
						path: '/cnpjCollection',
						sorter: {
							path: 'Name'
						}
					}">
					<headerToolbar>
						<OverflowToolbar>
							<ToolbarSpacer />
							<!-- <Button id="clearCompleted" enabled="{/itemsRemovable}" icon="sap-icon://delete" press=".clearCompleted"/> -->
						</OverflowToolbar>
					</headerToolbar>
					<columns>
						<Column width="12em">
							<Text text="{i18n>cnpj}" />
						</Column>
						<Column >
							<Text text="{i18n>corporateName}" />
						</Column>
						<Column minScreenWidth="Tablet" demandPopin="true" hAlign="End">
							<Text text="" />
						</Column>
					</columns>
					<items>
						<ColumnListItem vAlign="Middle">
							<cells>
								<!-- <ObjectIdentifier title="{cnpj}"/> -->
								<Text text="{cnpj}" />
								<Text text="{razaoSocial}" />
								<Button icon="sap-icon://decline"  
										type="Reject" visible="true" press="deleteCnpj"/>
							</cells>
						</ColumnListItem>
					</items>
				</Table>
			</form:SimpleForm>
		</WizardStep>
		<WizardStep id="manufacturerStep_" icon="sap-icon://action-settings"
					title="{i18n>manufacturerStep}"
					activate="onActivate">
			<Text text="Para os CNPJs, foram encontrados os seguintes fabricantes:"/>
			<Panel>
				<FlexBox id="cnpjsStepManufacturer" direction="Column" alignItems="Start" class="sapUiSmallMarginBottom sapUiTinyMarginTop"/>
			</Panel>
			<form:SimpleForm editable="true" layout="ResponsiveGridLayout">	
				<Table id="manufactureTable_" inset="false" 
					items="{
						path: '/manufacturerCollection',
						parameters : {
							$count : true
						},
						sorter: {
							path: 'Name'
						}
					}">
					<headerToolbar>
						<OverflowToolbar>
							<Title text="" id="titleManufacturer_" level="H2"/>
							<ToolbarSpacer />
							<SegmentedButton selectedKey="active" id="swichStatusManufacture_" selectionChange=".onFilterManufacture" class="sapMSegmentedButtonNoAutoWidth">
								<items>
									<SegmentedButtonItem text="{i18n>lblAtivos}" key="active"/>	
									<SegmentedButtonItem text="{i18n>lblExcluded}" key="excluded"/>
								</items>
							</SegmentedButton>
							<!-- <Button id="clearCompleted" enabled="{/itemsRemovable}" icon="sap-icon://delete" press=".clearCompleted"/> -->
						</OverflowToolbar>
					</headerToolbar>
					<columns>
						<Column >
							<Text text="" />
						</Column>
						<Column  demandPopin="true" hAlign="End">
							<Text text="" />
						</Column>
					</columns>
					<items>
						<ColumnListItem vAlign="Middle">
							<cells>
								<!-- <ObjectIdentifier title="{cnpj}"/> -->
								<Text text="{manufacturer}"/>
								<Button icon="{ path: 'status',formatter: '.formatter.iconBtnSwichDecision'}"  
										type="{ path: 'status',formatter: '.formatter.typeBtnSwichDecision'}" visible="true" press="deleteOrBackManufacture"/>
							</cells>
						</ColumnListItem>
					</items>
				</Table>
			</form:SimpleForm>
		</WizardStep>
		<WizardStep id="classStep" icon="sap-icon://switch-classes"
					title="{i18n>classStep}"
					activate="onActivate">
			<Text text="Para os Fabricantes"/>
			<Panel>
				<FlexBox id="StepClassManufac" direction="Column" alignItems="Start" class="sapUiSmallMarginBottom sapUiTinyMarginTop"/>
			</Panel>
			<form:SimpleForm editable="true" layout="ResponsiveGridLayout">	
				<Table id="classTable" inset="false" 
					items="{
						path: '/classCollection',
						sorter: {
							path: 'Name'
						}
					}">
					<headerToolbar>
						<OverflowToolbar>
							<Title text="" id="titleClass" level="H2"/>
							<ToolbarSpacer />
							<SegmentedButton selectedKey="active" id="swichStatusClass" selectionChange=".onFilterClass" class="sapMSegmentedButtonNoAutoWidth">
								<items>
									<SegmentedButtonItem text="{i18n>lblAtivos}" key="active"/>	
									<SegmentedButtonItem text="{i18n>lblExcluded}" key="excluded"/>
								</items>
							</SegmentedButton>
							<!-- <Button id="clearCompleted" enabled="{/itemsRemovable}" icon="sap-icon://delete" press=".clearCompleted"/> -->
						</OverflowToolbar>
					</headerToolbar>
					<columns>
						<Column >
							<Text text="" />
						</Column>
						<Column  demandPopin="true" hAlign="End">
							<Text text="" />
						</Column>
					</columns>
					<items>
						<ColumnListItem vAlign="Middle">
							<cells>
								<!-- <ObjectIdentifier title="{cnpj}"/> -->
								<Text text="{class}"/>
								<Button icon="{ path: 'status',formatter: '.formatter.iconBtnSwichDecision'}"  
										type="{ path: 'status',formatter: '.formatter.typeBtnSwichDecision'}" visible="true" press="deleteOrBackClass"/>
							</cells>
						</ColumnListItem>
					</items>
				</Table>
			</form:SimpleForm>
		</WizardStep>
		<WizardStep id="exclusivityLetterStep" icon="sap-icon://attachment"
					title="{i18n>exclusivityLetterStep}"
					activate="onActivate">
					<Text text="Nesta etapa anexe a Carta de Exclusividade"/>
				<form:SimpleForm editable="true" layout="ResponsiveGridLayout">	
				<Table
				id="table-uploadSet"
				sticky="ColumnHeaders,HeaderToolbar"
				width="auto"
				fixedLayout="false"
				inset="true"
				autoPopinMode="true"
				hiddenInPopin="None"
				items="{path: '/documentCollection', templateShareable: false}"
				selectionChange="onSelectionChange">
					<headerToolbar>
					<OverflowToolbar>
						<Title
								text="{i18n>documents} ({= ${/items}.length})"
								level="H2"
						/>
						<ToolbarSpacer />
                    <ToolbarSeparator />
					    <u:FileUploader buttonOnly="true" id="fileUpload" change="onChange" fileType="pdf" mimeType="pdf" buttonText="Upload"  />
						<!--<Button text="Upload" type="Default" press="pressFileUploader" ariaLabelledBy="editButtonLabel"/>
						
                    <upload:ActionsPlaceholder id="uploadButton" placeholderFor="UploadButtonPlaceholder" />
					-->
					</OverflowToolbar>
				</headerToolbar>

				<dependents>
						<plugins.UploadSetwithTable
						uploadUrl="/uploadFiles"
						multiple="true"
						beforeInitiatingItemUpload="onBeforeInitiatingItemUpload"
						beforeUploadStarts="onBeforeUploadStarts"
						itemRenamed="onDocumentRenamedSuccess"
						uploadCompleted="onUploadCompleted"
						onActivated="onPluginActivated"
						cloudFilePickerEnabled="true"
						actions="uploadButton"
						>
							<rowConfiguration>
								<upload.UploadItemConfiguration
								fileNamePath="fileName"
								mediaTypePath="mediaType"
								urlPath="url"
								previewablePath="previewable"
								fileSizePath="fileSize"
                                isTrustedSourcePath="trustedSource"
								/>
							</rowConfiguration>
						</plugins.UploadSetwithTable>
				</dependents>
				<columns>
					<Column id="fileName" importance="High">
						<header>
							<Label text="{i18n>fileName}" />
						</header>
					</Column>
					
					
					<Column id="lastModified">
						<header>
							<Label text="{i18n>lastModified}" />
						</header>
					</Column>
					<Column id="expiredDate">
						<header>
							<Label text="{i18n>expiredDate}" />
						</header>
					</Column>
					<Column id="actionButton" importance="High" />
            </columns>
			<items>
                <ColumnListItem
					press="onItemPress"
					highlight="{= ${uploadState} === 'Complete' ? 'Indication05' : null }"
                >

                <!-- Cells with cell template defining content for each column (cells and columns work with 1:1 mapping) -->
                    <cells>
                        <HBox>
                            <Image
                                src="{imageUrl}"
                                class="sapMUSTItemImage sapMUSTItemIcon"
                                visible="{= ${imageUrl} !== undefined}"
                            />
                            <core:Icon
                                src="{parts: ['mediaType', 'fileName'], formatter: '.getIconSrc' }"
                                color="white"
                                visible="{= ${imageUrl} === undefined || ${imageUrl} === '' }"
                                class="sapMUSTItemImage sapMUSTItemIcon"
                            />
                            <VBox
                                class="sapUiTinyMargin sapUiSmallMarginBegin"
                            >
                                <Link
                                    text="{fileName}"
                                    press="openPreview"
                                    class="sapUiTinyMarginBottom"
                                />
                                <Text text="{documentType}" />
                            </VBox>
                        </HBox>
                       
                       
                         <VBox>
                            <Text
                                class="sapUiTinyMarginTop"
                                text="{path: 'lastmodified', type: 'sap.ui.model.type.Date', formatOptions: {pattern: 'dd/MM/y HH:mm'}}"
                            />
                        </VBox>
						<VBox>
							<Text text="{expiredDate}" visible="{= ${newDocument} === false}"/>
							<DatePicker 
								required="true"
								visible="{= ${newDocument} === true}" value="{
								path: 'expiredDate',
								type: 'sap.ui.model.type.Date',
								formatOptions: {pattern: 'dd/MM/y'}}" />
						</VBox>
                       <Button
                            class="sapUiTinyMarginBegin"
                            type="Transparent"
                            icon="sap-icon://decline"
                            press="onRemoveHandler"
                        />
                    </cells>
                </ColumnListItem>
            </items>				
			</Table>
			</form:SimpleForm>
		</WizardStep>
	</Wizard>
	
</mvc:View>